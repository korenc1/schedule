

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Crown Shipping Live Schedule</title>

  
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

  <style>
    body {
      font-family: Calibri, Arial, sans-serif;
      margin: 16px;
      overflow-x: auto;
      background: #ffffff;
    }

    .page-title {
      margin: 0 auto 10px;
      text-align: center;
      font-size: 28px;
      font-weight: 900;
      color: #ffffff;
      letter-spacing: 0.2px;
      line-height: 1.15;
      background: #C80952;
      padding: 10px 12px;
      border-radius: 0;
      box-shadow: none;
      font-family: Calibri, Arial, sans-serif;
    }
    .page-title span {
      display: inline-block;
      padding: 0;
      border-radius: 0;
      background: transparent;
      border: 0;
      box-shadow: none;
    }

    .top-controls {
      margin: 10px auto 6px;
      width: auto;
      display: flex;
      align-items: flex-end;  
      justify-content: flex-start;
      gap: 14px;
      position: relative;
    }

    .logo-wrap { pointer-events: none; }
    .logo-img {
      height: 90px;
      max-width: 420px;
      width: auto;
      object-fit: contain;
      display: block;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.12));
    }

    .info-box { display:flex; flex-direction:row; align-items:flex-end; gap:22px; padding-bottom: 2px; }
    .info-text { font-size: 18px; color: #2b2b2b; line-height: 1.15; font-weight: 400; }

     
    .pdf-btn{
      font-family: Calibri, Arial, sans-serif;
      font-size: 15px;
      font-weight: 700;
      padding: 6px 14px;
      border: 1px solid rgba(0,0,0,0.18);
      background: #ffffff;
      color: #111827;
      cursor: pointer;
      border-radius: 0;
    }
    .pdf-btn:hover{ background: #f3f4f6; }
    .pdf-btn:focus{
      outline: 3px solid rgba(59, 130, 246, 0.55);
      outline-offset: 2px;
    }

     
    .search-wrap{
      margin-left: auto;
      padding-bottom: 2px;
      position: relative;
      display: flex;
      align-items: flex-end;
    }
    .search-input{
      width: 260px;
      max-width: 40vw;
      font-family: Calibri, Arial, sans-serif;
      font-size: 15px;
      padding: 7px 36px 7px 10px;  
      border: 2px solid #C80952;
      background: #ffffff;
      color: #111827;
      border-radius: 0;
      outline: none;
      box-sizing: border-box;
    }
    .search-input::placeholder{ color: rgba(17, 24, 39, 0.55); }

     
    .search-input:focus,
    .search-input:focus-visible{
      outline: none !important;
      box-shadow: none !important;
    }

    .clear-btn{
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      width: 22px;
      height: 22px;
      display: none;
      place-items: center;
      border: 0;
      background: transparent;
      color: #111827;
      cursor: pointer;
      border-radius: 0;
      font-family: Calibri, Arial, sans-serif;
      font-weight: 900;
      line-height: 1;
      user-select: none;
      padding: 0;
    }
    .clear-btn:hover{ background: #f3f4f6; }
    .clear-btn:focus{
      outline: 3px solid rgba(200, 9, 82, 0.25);
      outline-offset: 2px;
    }

    #blocks {
      margin-top: 0px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
    }

    .line-card { border-radius: 0; padding: 12px 12px 10px; box-sizing: border-box; background: #F5F5F5; }
    .line-card.block1 { background: #F5F5F5; }
    .line-card.block2 { background: #F5F5F5; }
    .line-card.block3, .line-card.block4, .line-card.block5, .line-card.block6 { background: #F5F5F5; }

    .line-title {
      font-weight: 800;
      font-size: 20px;
      margin: 2px 2px 10px;
      display: block;
      padding: 6px 8px;
      border-radius: 0;
    }
    .line-card.block1 .line-title { color: #D12E66; }
    .line-card.block2 .line-title { color: #2E88D1; }
    .line-card.block3 .line-title,
    .line-card.block4 .line-title,
    .line-card.block5 .line-title,
    .line-card.block6 .line-title { color: #D18D2E; }

    .tbl-wrap {
      width: 100%;
      border-radius: 0;
      overflow: hidden;
      box-sizing: border-box;
      background: rgba(255,255,255,0.60);
    }

    table { border-collapse: collapse; width: 100%; table-layout: fixed; box-sizing: border-box; border-radius: 0; }
    th, td {
      border: 1px solid rgba(0,0,0,0.08);
      padding: 8px;
      vertical-align: top;
      box-sizing: border-box;
      text-align: center;
      border-radius: 0;
    }
    th {
      background: rgba(255,255,255,0.70);
      font-weight: 700;
      font-size: 13.5px;
      white-space: nowrap;
      overflow: visible;
      text-overflow: clip;
    }
    td {
      background: rgba(255,255,255,0.92);
      font-size: 13.5px;
      white-space: nowrap;
      overflow: visible;
      text-overflow: clip;
    }
    th.th-remarks, td.td-remarks {
      white-space: normal !important;
      overflow-wrap: break-word !important;
      word-break: break-word !important;
      text-overflow: clip !important;
    }
    .align-left { text-align: left !important; }

    .closed-text { color: #dc2626 !important; font-weight: 800 !important; }

     
    .busy-overlay{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(255,255,255,0.92);
      z-index:20000;
      align-items:center;
      justify-content:center;
      pointer-events:all;
    }
    .busy-card{
      text-align:center;
      padding:18px 20px;
      border:1px solid rgba(0,0,0,0.12);
      background:#fff;
      box-shadow:0 10px 26px rgba(0,0,0,0.12);
      max-width: 520px;
      width: calc(100% - 48px);
    }
    .busy-title{
      font-size:26px;
      font-weight:900;
      letter-spacing:0.5px;
      margin-bottom:6px;
      color:#C80952;
    }
    .busy-sub{
      font-size:14px;
      opacity:0.75;
    }
  </style>

  

  
  <style id="a11yOverridesStyle"></style>

  
  <style>
    .a11y-fab {
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: 60px;
      height: 60px;
      border: 0;
      border-radius: 999px;
      background: #1d4ed8;
      color: #fff;
      display: grid;
      place-items: center;
      cursor: pointer;
      z-index: 10050;
      box-shadow: 0 10px 26px rgba(29, 78, 216, 0.38);
    }
    .a11y-fab:hover { background: #1e40af; }
    .a11y-fab:focus { outline: 3px solid rgba(59, 130, 246, 0.75); outline-offset: 2px; }

    .a11y-backdrop { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.45); z-index: 10040; display: none; }

    .a11y-panel {
      position: fixed;
      right: 16px;
      top: 16px;
      bottom: 16px;
      width: 390px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.28);
      z-index: 10060;
      transform: translateX(115%);
      transition: transform 180ms ease;
      display: flex;
      flex-direction: column;
    }
    body.a11y-open .a11y-backdrop { display: block; }
    body.a11y-open .a11y-panel { transform: translateX(0); }

    .a11y-panel__header {
      padding: 14px 14px 10px;
      border-bottom: 1px solid #eee;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .a11y-title { font-size: 18px; font-weight: 800; margin: 0; color: #111827; }
    .a11y-close { border: 0; background: #f3f4f6; cursor: pointer; border-radius: 10px; padding: 8px 10px; font-size: 14px; }
    .a11y-close:hover { background: #e5e7eb; }
    .a11y-panel__content { padding: 14px; overflow: auto; }

    .a11y-section { margin: 0 0 14px; padding: 12px; border: 1px solid #eee; border-radius: 12px; background: #fafafa; }
    .a11y-section h3 { margin: 0 0 8px; font-size: 14px; font-weight: 800; color: #111827; }
    .a11y-section p, .a11y-section li { font-size: 13px; line-height: 1.5; color: #374151; }

    .a11y-contact { margin-top: 10px; padding: 10px; border-radius: 12px; background: #ffffff; border: 1px solid #e5e7eb; }
    .a11y-contact a { font-weight: 800; text-decoration: underline; }

    .a11y-controls { display: grid; gap: 10px; }
    .a11y-row { display: flex; align-items: center; justify-content: space-between; gap: 10px; flex-wrap: wrap; }
    .a11y-row label { font-size: 13px; color: #111827; font-weight: 700; }

    .a11y-btn { border: 1px solid #e5e7eb; background: #fff; padding: 8px 10px; border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: 700; }
    .a11y-btn:hover { background: #f3f4f6; }
    .a11y-btn.primary { background: #111827; color: #fff; border-color: #111827; }
    .a11y-btn.primary:hover { background: #0b1220; }

    .a11y-select, .a11y-range { width: 200px; max-width: 100%; }
    .a11y-range { width: 220px; }

    .a11y-colors { display: none; gap: 10px; margin-top: 8px; }
    .a11y-colors.open { display: grid; }
    .a11y-colors .a11y-row { justify-content: flex-start; }
    .a11y-colors input[type="color"] { width: 42px; height: 34px; border: 0; background: transparent; padding: 0; cursor: pointer; }

    .a11y-toggle { width: 18px; height: 18px; cursor: pointer; }

    .page-footer { margin-top: 18px; padding: 14px 0 6px; text-align: center; font-size: 13px; color: #6b7280; }
    .page-footer a { color: inherit; font-weight: 700; text-decoration: underline; }
  </style>
</head>

<body data-generated-at="22/01/2026 11:05:02">
  <h1 class="page-title"><span>Crown Shipping Live Schedule</span></h1>

  
  <div id="busyOverlay" class="busy-overlay" aria-live="assertive" aria-hidden="true">
    <div class="busy-card">
      <div class="busy-title">PLEASE WAIT</div>
      <div class="busy-sub">Schedule is being updated…</div>
    </div>
  </div>

  <div id="topControls" class="top-controls">
    <div class="logo-wrap">
      <img id="logoImg" class="logo-img" alt="Crown Shipping" />
    </div>

    <div class="info-box">
      <div class="info-text">Last updated: <span id="globalUpdated">—</span></div>
      <button id="pdfBtn" class="pdf-btn" type="button">PDF</button>
    </div>

    <div class="search-wrap">
      <input id="searchInput" class="search search-input" type="text" placeholder="Search..." autocomplete="off" />
      <button id="clearSearchBtn" class="clear-btn" type="button" aria-label="Clear search">X</button>
    </div>
  </div>

  <div id="blocks"></div>

  <script>
    
    const SCHEDULE_DATA = {"updatedAt":"22/01/2026 11:04","headers":["VESSEL & VOYAGE","CODE RNR","MANIFEST","DG & AWKWARD DOCS","DOCS CLOSING & FINAL SI","ENTER TO PORT","ETA","REMARKS 1","REMARKS 2"],"rows":[{"line":"1 // MD1 - ASHDOD TO FAR EAST EXCLUDING PUSAN, XINGANG, DALIAN // USEC VIA PIRAEUS","cells":["YM WISH 0049E","0360","260103","CLOSED","21/01/2026 - 12:00","23/01/2026 - 10:00","25/01/2026","MD1","SUBJECT TO CHANGE"]},{"line":"1 // MD1 - ASHDOD TO FAR EAST EXCLUDING PUSAN, XINGANG, DALIAN // USEC VIA PIRAEUS","cells":["YM WORLD 0047E","0174","260104","26/01/2026 - 10:00","28/01/2026 - 12:00","30/01/2026 - 10:00","01/02/2026","MD1גכעי","SUBJECT TO CHANGE"]},{"line":"1 // MD1 - ASHDOD TO FAR EAST EXCLUDING PUSAN, XINGANG, DALIAN // USEC VIA PIRAEUS","cells":["YM WELLNESS 0047E","2217","260105","02/02/2026 - 10:00","04/02/2026 - 12:00","06/02/2026 - 10:00","08/02/2026","MD1","SUBJECT TO CHANGE"]},{"line":"1 // MD1 - ASHDOD TO FAR EAST EXCLUDING PUSAN, XINGANG, DALIAN // USEC VIA PIRAEUS","cells":["YM WONDROUS 0049E","0907","TBA","09/02/2026 - 10:00","11/02/2026 - 12:00","13/02/2026 - 10:00","15/02/2026","MD1","SUBJECT TO CHANGE"]},{"line":"2 // MD3 - HADAROM TO FAR EAST EXCLUDING TAIWAN PORTS","cells":["MSC RAYA 0604E","2920","260960","IRRELEVANT","CLOSED","CLOSED","WORKING","MD3","SUBJECT TO CHANGE"]},{"line":"2 // MD3 - HADAROM TO FAR EAST EXCLUDING TAIWAN PORTS","cells":["MSC DITTE 0605E","0383","260977","IRRELEVANT","25/01/2026 - 14:00","26/01/2026 - 20:00","27/01/2026","MD3","SUBJECT TO CHANGE"]},{"line":"2 // MD3 - HADAROM TO FAR EAST EXCLUDING TAIWAN PORTS","cells":["MSC LENI 0606E","TBA","260986","IRRELEVANT","29/01/2026 - 09:00","30/01/2026 - 11:00","01/02/2026","MD3","SUBJECT TO CHANGE"]},{"line":"3 // AD1 - ASHDOD ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA","cells":["ADMIRAL SUN 0004W","2648","262194","CLOSED","CLOSED","CLOSED","21/01/2026","AD1","SUBJECT TO CHANGE"]},{"line":"3 // AD1 - ASHDOD ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA","cells":["CHATTANOOGA 0047W","0723","262192","CLOSED","CLOSED","CLOSED","21/01/2026","AD1","SUBJECT TO CHANGE"]},{"line":"3 // AD1 - ASHDOD ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA","cells":["MITO 0058W","2473","TBA","27/01/2026 - 10:00","02/02/2026 - 10:00","03/02/2026 - 10:00","04/02/2026","AD1","SUBJECT TO CHANGE"]},{"line":"4 // ILX - ASHDOD TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0017N","7387","263327","IRRELEVANT","CLOSED","CLOSED","22/01/2026 00:00","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"4 // ILX - ASHDOD TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0018N","7387","TBA","IRRELEVANT","29/01/2026 - 10:00","30/01/2026 - 10:00","01/02/2026 00:00","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"4 // ILX - ASHDOD TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0019N","7387","TBA","IRRELEVANT","05/02/2026 - 10:00","08/02/2026 - 10:00","09/02/2026 00:00","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"4 // ILX - ASHDOD TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0020N","7387","TBA","IRRELEVANT","12/02/2026 - 10:00","15/02/2026 - 10:00","16/02/2026 00:00","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"5 // ILX - HAIFA TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0017N","7387","263327","IRRELEVANT","25/01/2026 - 09:00","25/01/2026 - 15:00","25/01/2026","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"5 // ILX - HAIFA TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0018N","7387","TBA","IRRELEVANT","27/01/2026 - 09:00","28/01/2026 - 11:00","29/01/2026","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"5 // ILX - HAIFA TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0019N","7387","TBA","IRRELEVANT","05/02/2026 - 09:00","06/02/2026 - 11:00","08/02/2026","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"5 // ILX - HAIFA TO DAMIETTA / EAST, FE / N.EUROPE VIA T/S","cells":["ADMIRAL NEPTUNE 0020N","7387","TBA","IRRELEVANT","12/02/2026 - 09:00","13/02/2026 - 11:00","15/02/2026","EGDAM ONLY (ILX)","SUBJECT TO CHANGE"]},{"line":"6 // AD1 - HAIFA ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA / INDIA VIA PIRAEUS","cells":["CHATTANOOGA 0047W","0723","262192","CLOSED","CLOSED","CLOSED","WORKING","AD1","SUBJECT TO CHANGE"]},{"line":"6 // AD1 - HAIFA ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA / INDIA VIA PIRAEUS","cells":["MITO 0058W","2473","TBA","26/01/2026 - 10:00","29/01/2026 - 09:00","01/02/2026 - 10:00","02/02/2026","AD1","SUBJECT TO CHANGE"]},{"line":"6 // AD1 - HAIFA ADRIATIC DIRECT & NORTHEN EUROPE VIA DAMIETTA / INDIA VIA PIRAEUS","cells":["ADMIRAL SUN 0005W","2648","TBA","03/02/2026 - 10:00","08/02/2026 - 09:00","09/02/2026 - 10:00","10/02/2026","AD1","SUBJECT TO CHANGE"]}]};
    const LOGO_DATAURI = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOAAAADICAYAAADx0u26AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjNDJkOTlhOS1jNTE0LTY1NDctOTUwZC04ODk0NDUxODkzOTgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDgzOUU0MEEzNjQwMTFFOEI0NTBEMjYxRDhERTM5NEIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDgzOUU0MDkzNjQwMTFFOEI0NTBEMjYxRDhERTM5NEIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDBlZjkxM2MtMWFiZS04ZTRmLWIzZmMtYjIyZWEzNzU3NjZmIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZjU5NjZkNDAtMzU5OC0xMWU4LWJmMzUt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";
    const STATUS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbz6qupojHYJhLcUTyhrUW8oUzEXBx_9oqPuSE7c2mxIrJCtluEtKNZUbYplCMj4CfuT7Q/exec";
    window.__STATUS_WEBAPP_URL = STATUS_WEBAPP_URL; 
    

    const blocksEl = document.getElementById('blocks');
    const globalUpdatedEl = document.getElementById('globalUpdated');
    const topControlsEl = document.getElementById('topControls');
    const logoImg = document.getElementById('logoImg');
    const pdfBtn = document.getElementById('pdfBtn');
    const searchInput = document.getElementById('searchInput');
    const clearSearchBtn = document.getElementById('clearSearchBtn');

    
    const busyOverlayEl = document.getElementById('busyOverlay');
    let liveBusyActive = false;
    window.__LIVE_BUSY_ACTIVE = false;

    function setBusyActive_(on){
      liveBusyActive = !!on;
      window.__LIVE_BUSY_ACTIVE = liveBusyActive;

      if (busyOverlayEl) {
        busyOverlayEl.style.display = liveBusyActive ? 'flex' : 'none';
        busyOverlayEl.setAttribute('aria-hidden', liveBusyActive ? 'false' : 'true');
      }

      document.documentElement.style.overflow = liveBusyActive ? 'hidden' : '';

      
      if (globalUpdatedEl) {
        globalUpdatedEl.textContent = liveBusyActive ? 'PLEASE WAIT' : (allData.updatedAt || '—');
      }
    }

    
    let __liveState = '';
    let __liveStableCount = 0;   
    let __liveFailCount = 0;
    let __liveTimer = null;
    let __liveInFlight = false;

    const LIVE_FAST_MS   = 2000;   
    const LIVE_STAGE1_MS = 3000;   
    const LIVE_STAGE2_MS = 15000;  
    const LIVE_STAGE3_MS = 60000;  

    function nextNormalInterval_(){
      if (__liveStableCount < 10) return LIVE_STAGE1_MS;   
      if (__liveStableCount < 30) return LIVE_STAGE2_MS;   
      return LIVE_STAGE3_MS;
    }

    function scheduleLive_(ms){
      try { if (__liveTimer) clearTimeout(__liveTimer); } catch(e) {}
      __liveTimer = setTimeout(liveCheckOnce_, Math.max(200, Number(ms || 0)));
    }

    function liveCheckOnce_(){
      if (!STATUS_WEBAPP_URL) return;
      if (__liveInFlight) return;

      
      if (document.visibilityState !== 'visible') {
        scheduleLive_(LIVE_STAGE3_MS);
        return;
      }

      __liveInFlight = true;
      let finished = false;

      const cb = '__liveCb_' + Math.random().toString(36).slice(2);
      const u = new URL(STATUS_WEBAPP_URL);
      u.searchParams.set('callback', cb);
      
      if (__liveState) u.searchParams.set('state', __liveState);
      u.searchParams.set('t', Date.now());

      const s = document.createElement('script');
      s.src = u.toString();
      s.async = true;

      const timeoutMs = 12000;
      const timeoutId = setTimeout(() => {
        if (finished) return;
        cleanup_();
        __liveInFlight = false;
        __liveFailCount++;
        const backoff = Math.min(LIVE_STAGE3_MS, 2000 * Math.pow(2, Math.min(__liveFailCount, 5)));
        scheduleLive_(backoff);
      }, timeoutMs);

      function cleanup_(){
        finished = true;
        try { clearTimeout(timeoutId); } catch(e) {}
        try { delete window[cb]; } catch(e) {}
        try { s.remove(); } catch(e) {}
      }

      window[cb] = (data) => {
        cleanup_();
        __liveInFlight = false;
        handleLiveStatus_(data);
      };

      s.onerror = () => {
        cleanup_();
        __liveInFlight = false;
        __liveFailCount++;
        const backoff = Math.min(LIVE_STAGE3_MS, 2000 * Math.pow(2, Math.min(__liveFailCount, 5)));
        scheduleLive_(backoff);
      };

      document.head.appendChild(s);
    }

    function handleLiveStatus_(data){
      if (!data) {
        __liveFailCount++;
        scheduleLive_(Math.min(LIVE_STAGE3_MS, 2000 * Math.pow(2, Math.min(__liveFailCount, 5))));
        return;
      }

      __liveFailCount = 0;
      __liveState = data.state || __liveState;

      const isBusy = !!data.busy;
      const liveGen = String(data.liveGeneratedAt || '');
      const currentGen = String(document.body.getAttribute('data-generated-at') || '');

      if (isBusy) {
        __liveStableCount = 0;
        setBusyActive_(true);
        scheduleLive_(LIVE_FAST_MS);
        return;
      }

      
      if (liveGen && currentGen && liveGen !== currentGen) {
        __liveStableCount = 0;
        setBusyActive_(true);
        const base = window.location.href.split('?')[0];
        window.location.replace(base + '?v=' + encodeURIComponent(liveGen) + '&r=' + Date.now());
        return;
      }

      
      setBusyActive_(false);
      if (data.lastUpdatedText && globalUpdatedEl) {
        globalUpdatedEl.textContent = String(data.lastUpdatedText);
      }

      __liveStableCount++;
      scheduleLive_(nextNormalInterval_());
    }

    function startLiveStatus_(){
      if (!STATUS_WEBAPP_URL) return;

      
      __liveStableCount = 0;
      __liveFailCount = 0;
      scheduleLive_(250);

      
      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
          __liveStableCount = 0;
          __liveFailCount = 0;
          scheduleLive_(250);
        }
      });

      window.addEventListener('focus', () => {
        __liveStableCount = 0;
        __liveFailCount = 0;
        scheduleLive_(250);
      });
    }

    

    let allData = SCHEDULE_DATA || { updatedAt: null, headers: [], rows: [] };
    let globalColWidthsPx = [];
    let globalCardOuterWidthPx = null;

    let currentSearch = '';

    if (LOGO_DATAURI) logoImg.src = LOGO_DATAURI;

    function safeFilePart_(s){
      return String(s || '')
        .replace(/[^\w\-]+/g, '_')
        .replace(/_+/g, '_')
        .replace(/^_+|_+$/g,'')
        .slice(0, 60);
    }

    function norm(h){ return String(h || '').toLowerCase().replace(/\s+/g,' ').trim(); }
    function isVesselHeader(h){ const x = norm(h); return x.includes('vessel') || x.includes('ship'); }
    function isRemarks1Header(h){ const x = norm(h); return x.includes('remarks 1') || x.includes('remark 1') || x.includes('remarks1') || x.includes('remark1'); }
    function isRemarks2Header(h){ const x = norm(h); return x.includes('remarks 2') || x.includes('remark 2') || x.includes('remarks2') || x.includes('remark2'); }
    function isRemarksLimitedHeader(h){ return isRemarks1Header(h) || isRemarks2Header(h); }

    function computeLayout(data) {
      const headers = Array.isArray(data.headers) ? data.headers : [];
      const rows = Array.isArray(data.rows) ? data.rows : [];
      const colCount = headers.length;

      if (!colCount) return { colWidthsPx: [], cardOuterWidthPx: Math.max(720, (window.innerWidth || 1200) - 32) };

      const maxDataLen = new Array(colCount).fill(0);
      for (const r of rows) {
        const cells = Array.isArray(r.cells) ? r.cells : [];
        for (let i = 0; i < colCount; i++) {
          const v = String(cells[i] ?? '').trim();
          if (v.length > maxDataLen[i]) maxDataLen[i] = v.length;
        }
      }

      const PAD = 34;
      const CHAR_TH = 8.4;
      const CHAR_TD = 7.4;
      const MIN_COL = 90;
      const MAX_REMARKS = 360;

      const widths = new Array(colCount).fill(0);
      for (let i = 0; i < colCount; i++) {
        const h = String(headers[i] ?? '').trim();
        const wHeader = PAD + h.length * CHAR_TH;
        const wData   = PAD + maxDataLen[i] * CHAR_TD;
        const vesselBoost = isVesselHeader(h) ? 18 : 0;

        let w = Math.max(MIN_COL, Math.ceil(Math.max(wHeader, wData) + vesselBoost));
        if (isRemarksLimitedHeader(h)) w = Math.min(w, MAX_REMARKS);
        widths[i] = w;
      }

      const totalInner = widths.reduce((a,b)=>a+b,0);
      const cardOuter = totalInner + 24;

      return { colWidthsPx: widths.map(w => `${w}px`), cardOuterWidthPx: cardOuter };
    }

    function groupRows(rows) {
      const groups = new Map();
      rows.forEach(r => {
        const key = (r.line || '').trim() || 'No Line';
        if (!groups.has(key)) groups.set(key, []);
        groups.get(key).push(r);
      });
      return groups;
    }

    function escapeHtml(s) {
      return String(s ?? '')
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    function isClosedCell(v){
      return String(v ?? '').trim().toUpperCase() === 'CLOSED';
    }

    function renderBlocks(groupedMap, headers) {
      const headerLabels = Array.isArray(headers) ? headers : [];
      const colCount = headerLabels.length || 1;

      let vesselIdx = -1;
      for (let i = 0; i < colCount; i++) { if (isVesselHeader(headerLabels[i])) { vesselIdx = i; break; } }

      let blockIndex = 0;
      for (const [line, items] of groupedMap.entries()) {
        blockIndex++;

        const card = document.createElement('div');
        card.className = 'line-card block' + blockIndex;
        if (globalCardOuterWidthPx) card.style.width = globalCardOuterWidthPx + 'px';

        const title = document.createElement('div');
        title.className = 'line-title';
        title.innerHTML = `<span>${escapeHtml(line)}</span>`;

        const wrap = document.createElement('div');
        wrap.className = 'tbl-wrap';

        const table = document.createElement('table');

        const colgroup = document.createElement('colgroup');
        for (let i = 0; i < colCount; i++) {
          const col = document.createElement('col');
          if (globalColWidthsPx[i]) col.style.width = globalColWidthsPx[i];
          colgroup.appendChild(col);
        }
        table.appendChild(colgroup);

        const thead = document.createElement('thead');
        const trh = document.createElement('tr');
        trh.innerHTML = headerLabels.map((h, i) => {
          const classes = [];
          if (i === vesselIdx) classes.push('align-left');
          if (isRemarksLimitedHeader(h)) classes.push('th-remarks');
          return `<th class="${classes.join(' ')}">${escapeHtml(h)}</th>`;
        }).join('');
        thead.appendChild(trh);

        const tb = document.createElement('tbody');
        items.forEach(r => {
          const tr = document.createElement('tr');
          const cells = Array.isArray(r.cells) ? r.cells : [];
          tr.innerHTML = cells.map((c, i) => {
            const classes = [];
            if (i === vesselIdx) classes.push('align-left');
            if (isRemarksLimitedHeader(headerLabels[i])) classes.push('td-remarks');

            const cellHtml = isClosedCell(c)
              ? `<span class="closed-text">${escapeHtml(c)}</span>`
              : `${escapeHtml(c)}`;

            return `<td class="${classes.join(' ')}">${cellHtml}</td>`;
          }).join('');
          tb.appendChild(tr);
        });

        table.appendChild(thead);
        table.appendChild(tb);
        wrap.appendChild(table);
        card.appendChild(title);
        card.appendChild(wrap);
        blocksEl.appendChild(card);
      }
    }

    function applySearchFilter_(){
      const q = String(currentSearch || '').trim().toLowerCase();
      const cards = blocksEl.querySelectorAll('.line-card');

      cards.forEach(card => {
        const titleText = (card.querySelector('.line-title')?.textContent || '').toLowerCase();
        const rows = card.querySelectorAll('tbody tr');

        if (!q) {
          card.style.display = '';
          rows.forEach(tr => tr.style.display = '');
          return;
        }

        if (titleText.includes(q)) {
          card.style.display = '';
          rows.forEach(tr => tr.style.display = '');
          return;
        }

        let anyVisible = false;
        rows.forEach(tr => {
          const txt = (tr.textContent || '').toLowerCase();
          const show = txt.includes(q);
          tr.style.display = show ? '' : 'none';
          if (show) anyVisible = true;
        });

        card.style.display = anyVisible ? '' : 'none';
      });
    }

    function syncClearBtn_(){
      if (!clearSearchBtn) return;
      const hasText = String(searchInput?.value || '').trim().length > 0;
      clearSearchBtn.style.display = hasText ? 'grid' : 'none';
    }

    function renderAll() {
      globalUpdatedEl.textContent = liveBusyActive ? 'PLEASE WAIT' : (allData.updatedAt || '—');
      blocksEl.innerHTML = '';

      const headers = Array.isArray(allData.headers) ? allData.headers : [];
      const rows = Array.isArray(allData.rows) ? allData.rows : [];

      const layout = computeLayout(allData);
      globalColWidthsPx = layout.colWidthsPx;
      globalCardOuterWidthPx = layout.cardOuterWidthPx;

      if (topControlsEl && globalCardOuterWidthPx) topControlsEl.style.width = globalCardOuterWidthPx + 'px';

      renderBlocks(groupRows(rows), headers);
      applySearchFilter_();
      syncClearBtn_();
    }

    if (searchInput) {
      searchInput.addEventListener('input', () => {
        currentSearch = searchInput.value || '';
        applySearchFilter_();
        syncClearBtn_();
      });
    }

    if (clearSearchBtn) {
      clearSearchBtn.addEventListener('click', () => {
        if (searchInput) searchInput.value = '';
        currentSearch = '';
        applySearchFilter_();
        syncClearBtn_();
        if (searchInput) searchInput.focus();
      });
      clearSearchBtn.style.display = 'none';
    }

    
    function filteredDataForPdf_() {
      const q = String(currentSearch || '').trim().toLowerCase();
      const headers = Array.isArray(allData.headers) ? allData.headers : [];
      const rows = Array.isArray(allData.rows) ? allData.rows : [];

      if (!q) return allData;

      const outRows = rows.filter(r => {
        const line = String(r.line || '').toLowerCase();
        if (line.includes(q)) return true;

        const cells = Array.isArray(r.cells) ? r.cells : [];
        const joined = cells.map(x => String(x ?? '').toLowerCase()).join(' ');
        return joined.includes(q);
      });

      return { updatedAt: allData.updatedAt || null, headers, rows: outRows };
    }

    function parseDataUriFormat_(dataUri){
      const m = String(dataUri || '').match(/^data:(image\/(png|jpeg|jpg));base64,/i);
      if (!m) return null;
      const type = m[2].toLowerCase();
      if (type === 'jpg') return 'JPEG';
      if (type === 'jpeg') return 'JPEG';
      if (type === 'png') return 'PNG';
      return null;
    }

    function blockTitleColor_(idx){
      if (idx === 1) return [209, 46, 102];   
      if (idx === 2) return [46, 136, 209];   
      return [209, 141, 46];                  
    }

    function getImageNaturalSize_(dataUri){
      return new Promise((resolve) => {
        const img = new Image();
        img.onload = () => resolve({ w: img.naturalWidth || img.width, h: img.naturalHeight || img.height });
        img.onerror = () => resolve(null);
        img.src = dataUri;
      });
    }

    async function downloadPdf_(){
      if (!window.jspdf || !window.jspdf.jsPDF) return;

      const data = filteredDataForPdf_();
      const headers = Array.isArray(data.headers) ? data.headers : [];
      const rows = Array.isArray(data.rows) ? data.rows : [];

      const gen = document.body.getAttribute('data-generated-at') || '';
      const fileStamp = safeFilePart_(gen) || safeFilePart_(data.updatedAt) || 'schedule';
      const filename = `Crown_Schedule_${fileStamp}.pdf`;

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'landscape', unit: 'pt', format: 'a4' });

      const pageW = doc.internal.pageSize.getWidth();
      const pageH = doc.internal.pageSize.getHeight();

      const BAR_COLOR = [200, 9, 82]; 
      const MARGIN_L = 32;
      const MARGIN_R = 32;
      const MARGIN_B = 32;
      const BAR_H = 34;
      const HEADER_H = 92; 

      const logoFmt = parseDataUriFormat_(LOGO_DATAURI);
      const logoData = LOGO_DATAURI && logoFmt ? LOGO_DATAURI : null;

      
      let logoWpt = 0;
      let logoHpt = 0;
      if (logoData) {
        const sz = await getImageNaturalSize_(logoData);
        if (sz && sz.w && sz.h) {
          const maxW = 240;  
          const maxH = 44;   
          const scale = Math.min(maxW / sz.w, maxH / sz.h);
          logoWpt = sz.w * scale;
          logoHpt = sz.h * scale;
        }
      }

      function drawHeader_(){
        
        doc.setFillColor(BAR_COLOR[0], BAR_COLOR[1], BAR_COLOR[2]);
        doc.rect(0, 0, pageW, BAR_H, 'F');

        
        doc.setTextColor(255, 255, 255);
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(15);
        doc.text('Crown Shipping Live Schedule', pageW / 2, 22, { align: 'center' });

        
        doc.setTextColor(17, 24, 39);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);

        const infoY = BAR_H + 22;

        
        if (logoData && logoWpt > 0 && logoHpt > 0) {
          try {
            doc.addImage(logoData, logoFmt, MARGIN_L, BAR_H + 8, logoWpt, logoHpt, undefined, 'FAST');
          } catch (e) {}
        }

        
        const lu = data.updatedAt || '—';
        doc.text(`Last updated: ${lu}`, pageW - MARGIN_R, infoY, { align: 'right' });

        
        doc.setDrawColor(220, 220, 220);
        doc.setLineWidth(1);
        doc.line(MARGIN_L, HEADER_H, pageW - MARGIN_R, HEADER_H);
      }

      drawHeader_();

      
      const grouped = groupRows(rows);
      let blockIndex = 0;

      let y = HEADER_H + 18;

      
      function ensureSpace_(needed){
        if (y + needed <= pageH - MARGIN_B) return;
        doc.addPage();
        drawHeader_();
        y = HEADER_H + 18;
      }

      
      for (const [line, items] of grouped.entries()) {
        blockIndex++;

        
        ensureSpace_(22);
        const col = blockTitleColor_(blockIndex);

        doc.setFont('helvetica', 'bold');
        doc.setFontSize(12);
        doc.setTextColor(col[0], col[1], col[2]);
        doc.text(String(line || ''), MARGIN_L, y);
        y += 8;

        
        const body = items.map(r => Array.isArray(r.cells) ? r.cells.map(x => (x === null || x === undefined) ? '' : String(x)) : []);
        const head = [headers.map(h => (h === null || h === undefined) ? '' : String(h))];

        
        doc.autoTable({
          startY: y + 6,
          head,
          body,
          margin: { left: MARGIN_L, right: MARGIN_R, top: HEADER_H + 14, bottom: MARGIN_B },
          styles: {
            font: 'helvetica',
            fontSize: 9,
            cellPadding: 4,
            valign: 'top',
            overflow: 'linebreak',
            lineColor: [0, 0, 0],
            lineWidth: 0.2
          },
          headStyles: {
            fillColor: [243, 244, 246],
            textColor: [17, 24, 39],
            fontStyle: 'bold'
          },
          bodyStyles: {
            fillColor: [255, 255, 255],
            textColor: [17, 24, 39]
          },
          didParseCell: function (hookData) {
            const raw = hookData.cell && hookData.cell.raw;
            if (String(raw || '').trim().toUpperCase() === 'CLOSED') {
              hookData.cell.styles.textColor = [220, 38, 38];
              hookData.cell.styles.fontStyle = 'bold';
            }
          },
          didDrawPage: function () {
            
            drawHeader_();
          }
        });

        y = (doc.lastAutoTable && doc.lastAutoTable.finalY) ? (doc.lastAutoTable.finalY + 18) : (y + 18);
      }

      doc.save(filename);
    }

    if (pdfBtn) {
      pdfBtn.addEventListener('click', () => { downloadPdf_(); });
    }

    window.addEventListener('resize', renderAll);
    renderAll();

    
    startLiveStatus_();
  </script>

  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        (function(){
          const STORAGE_KEY = 'crown_a11y_settings_v1';

          const fab = document.getElementById('a11yFab');
          const panel = document.getElementById('a11yPanel');
          const backdrop = document.getElementById('a11yBackdrop');
          const closeBtn = document.getElementById('a11yClose');
          const footerLink = document.getElementById('a11yFooterLink');

          const themeSel = document.getElementById('a11yTheme');
          const scaleRange = document.getElementById('a11yScale');
          const btnSmaller = document.getElementById('a11ySmaller');
          const btnBigger = document.getElementById('a11yBigger');
          const btnReset = document.getElementById('a11yReset');

          const customWrap = document.getElementById('a11yCustomColors');
          const bgPick = document.getElementById('a11yBg');
          const textPick = document.getElementById('a11yText');
          const linkPick = document.getElementById('a11yLink');

          const underlineCb = document.getElementById('a11yUnderlineLinks');
          const lineHeightCb = document.getElementById('a11yLineHeight');
          const letterSpaceCb = document.getElementById('a11yLetterSpacing');
          const readableFontCb = document.getElementById('a11yReadableFont');
          const reduceMotionCb = document.getElementById('a11yReduceMotion');

          const overridesStyle = document.getElementById('a11yOverridesStyle');

          if (!fab || !panel || !backdrop || !closeBtn || !themeSel || !scaleRange || !btnSmaller || !btnBigger || !btnReset || !customWrap || !bgPick || !textPick || !linkPick || !overridesStyle) {
            return;
          }

          const DEFAULT = {
            theme: 'default',
            scale: 1,
            bg: '#ffffff',
            text: '#111111',
            link: '#2563eb',
            underlineLinks: false,
            increaseLineHeight: false,
            increaseLetterSpacing: false,
            readableFont: false,
            reduceMotion: false
          };

          function loadSettings(){
            try{
              const raw = localStorage.getItem(STORAGE_KEY);
              if(!raw) return {...DEFAULT};
              const parsed = JSON.parse(raw);
              return { ...DEFAULT, ...parsed };
            }catch(e){
              return {...DEFAULT};
            }
          }

          function saveSettings(s){
            try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }catch(e){}
          }

          function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

          function buildCss(s){
            const scale = Number(s.scale || 1);

            let css = `
              :root{ --a11y-scale: ${scale}; }
              body{ font-size: calc(16px * var(--a11y-scale)) !important; }
              .info-text{ font-size: calc(20px * var(--a11y-scale)) !important; }
              th{ font-size: calc(13.5px * var(--a11y-scale)) !important; }
              td{ font-size: calc(13.5px * var(--a11y-scale)) !important; }
              .line-title{ font-size: calc(20px * var(--a11y-scale)) !important; }
              button{ font-size: calc(14px * var(--a11y-scale)) !important; }
              .search{ font-size: calc(14px * var(--a11y-scale)) !important; }
              .muted{ font-size: calc(12px * var(--a11y-scale)) !important; }
            `;

            if (scale > 1) {
              css += `
                th, td{
                  white-space: normal !important;
                  overflow-wrap: break-word !important;
                  word-break: break-word !important;
                }
              `;
            }

            if(s.theme === 'high'){
              css += `
                body{ background:#ffffff !important; color:#000 !important; }
                a{ color:#0000EE !important; }
                .line-card{ background:#ffffff !important; border-color:#000 !important; }
                .tbl-wrap{ background:#ffffff !important; }
                th, td{ background:#ffffff !important; color:#000 !important; border-color:#000 !important; }
                .line-title{ color:#000 !important; }
                .info-text{ color:#000 !important; }
              `;
            } else if(s.theme === 'dark'){
              css += `
                body{ background:#0b1220 !important; color:#f8fafc !important; }
                a{ color:#93c5fd !important; }
                .info-text{ color:#f8fafc !important; }
                .line-card{ background:#111827 !important; border-color:#334155 !important; }
                .tbl-wrap{ background:#0b1220 !important; }
                th{ background:#111827 !important; color:#f8fafc !important; border-color:#334155 !important; }
                td{ background:#0b1220 !important; color:#f8fafc !important; border-color:#334155 !important; }
                .line-title{ color:#f8fafc !important; }
                .search{ background:#0b1220 !important; color:#f8fafc !important; border-color:#334155 !important; }
              `;
            } else if(s.theme === 'soft'){
              css += `
                body{ background:#f6f7fb !important; color:#111827 !important; }
                a{ color:#1d4ed8 !important; }
                .line-card{ border-color:#d1d5db !important; }
                th{ background: rgba(255,255,255,0.85) !important; }
                td{ background: rgba(255,255,255,0.95) !important; }
                .info-text{ color:#111827 !important; }
              `;
            } else if(s.theme === 'custom'){
              const bg = s.bg || '#ffffff';
              const text = s.text || '#111111';
              const link = s.link || '#2563eb';
              css += `
                body{ background:${bg} !important; color:${text} !important; }
                a{ color:${link} !important; }
                .line-title, th, td{ color:${text} !important; }
                .info-text{ color:${text} !important; }
              `;
            }

            if (s.underlineLinks) css += `a{ text-decoration: underline !important; }`;
            if (s.increaseLineHeight) css += `body, p, li, td, th{ line-height: 1.8 !important; }`;
            if (s.increaseLetterSpacing) css += `body, p, li, td, th{ letter-spacing: 0.04em !important; }`;
            if (s.readableFont) css += `body, button, input, select, textarea{ font-family: Verdana, Arial, sans-serif !important; }`;
            if (s.reduceMotion) css += `*{ transition: none !important; animation: none !important; scroll-behavior: auto !important; }`;

            return css;
          }

          function apply(s){
            overridesStyle.textContent = buildCss(s);
            window.dispatchEvent(new Event('a11y:changed'));
          }

          function setUiFromSettings(s){
            themeSel.value = s.theme;
            scaleRange.value = String(s.scale);
            bgPick.value = s.bg;
            textPick.value = s.text;
            linkPick.value = s.link;

            customWrap.classList.toggle('open', s.theme === 'custom');

            if (underlineCb) underlineCb.checked = !!s.underlineLinks;
            if (lineHeightCb) lineHeightCb.checked = !!s.increaseLineHeight;
            if (letterSpaceCb) letterSpaceCb.checked = !!s.increaseLetterSpacing;
            if (readableFontCb) readableFontCb.checked = !!s.readableFont;
            if (reduceMotionCb) reduceMotionCb.checked = !!s.reduceMotion;
          }

          function openPanel(){
            document.body.classList.add('a11y-open');
            panel.setAttribute('aria-hidden','false');
            backdrop.setAttribute('aria-hidden','false');
            setTimeout(() => themeSel.focus(), 0);
          }

          function closePanel(){
            document.body.classList.remove('a11y-open');
            panel.setAttribute('aria-hidden','true');
            backdrop.setAttribute('aria-hidden','true');
            setTimeout(() => fab.focus(), 0);
          }

          let settings = loadSettings();
          apply(settings);
          setUiFromSettings(settings);

          fab.addEventListener('click', openPanel);
          if (footerLink) footerLink.addEventListener('click', (e)=>{ e.preventDefault(); openPanel(); });

          closeBtn.addEventListener('click', closePanel);
          backdrop.addEventListener('click', closePanel);

          document.addEventListener('keydown', (e)=>{
            if(e.key === 'Escape' && document.body.classList.contains('a11y-open')) closePanel();
          });

          themeSel.addEventListener('change', ()=>{
            settings.theme = themeSel.value;
            customWrap.classList.toggle('open', settings.theme === 'custom');
            saveSettings(settings);
            apply(settings);
          });

          scaleRange.addEventListener('input', ()=>{
            settings.scale = Number(scaleRange.value);
            saveSettings(settings);
            apply(settings);
          });

          btnSmaller.addEventListener('click', ()=>{
            settings.scale = clamp((Number(settings.scale) || 1) - 0.1, 1, 1.6);
            scaleRange.value = String(settings.scale);
            saveSettings(settings);
            apply(settings);
          });

          btnBigger.addEventListener('click', ()=>{
            settings.scale = clamp((Number(settings.scale) || 1) + 0.1, 1, 1.6);
            scaleRange.value = String(settings.scale);
            saveSettings(settings);
            apply(settings);
          });

          function customChanged(){
            settings.bg = bgPick.value;
            settings.text = textPick.value;
            settings.link = linkPick.value;
            saveSettings(settings);
            apply(settings);
          }

          bgPick.addEventListener('input', customChanged);
          textPick.addEventListener('input', customChanged);
          linkPick.addEventListener('input', customChanged);

          function updateToggles(){
            if (underlineCb) settings.underlineLinks = underlineCb.checked;
            if (lineHeightCb) settings.increaseLineHeight = lineHeightCb.checked;
            if (letterSpaceCb) settings.increaseLetterSpacing = letterSpaceCb.checked;
            if (readableFontCb) settings.readableFont = readableFontCb.checked;
            if (reduceMotionCb) settings.reduceMotion = reduceMotionCb.checked;
            saveSettings(settings);
            apply(settings);
          }

          if (underlineCb) underlineCb.addEventListener('change', updateToggles);
          if (lineHeightCb) lineHeightCb.addEventListener('change', updateToggles);
          if (letterSpaceCb) letterSpaceCb.addEventListener('change', updateToggles);
          if (readableFontCb) readableFontCb.addEventListener('change', updateToggles);
          if (reduceMotionCb) reduceMotionCb.addEventListener('change', updateToggles);

          btnReset.addEventListener('click', ()=>{
            settings = {...DEFAULT};
            try{ localStorage.removeItem(STORAGE_KEY); }catch(e){}
            apply(settings);
            setUiFromSettings(settings);
          });
        })();
      });
  </script>

  

  <button id="a11yFab" class="a11y-fab" type="button" aria-label="Accessibility options">
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M12 6.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" fill="currentColor"/>
      <path d="M4.5 8.5c0-.55.45-1 1-1h13c.55 0 1 .45 1 1s-.45 1-1 1H14v3.2l3.1 7.4c.22.5-.02 1.1-.52 1.32-.5.22-1.1-.02-1.32-.52L12.9 16h-1.8l-2.36 5.9c-.22.5-.82.74-1.32.52-.5-.22-.74-.82-.52-1.32L10 12.7V9.5H5.5c-.55 0-1-.45-1-1Z" fill="currentColor"/>
    </svg>
  </button>

  <div id="a11yBackdrop" class="a11y-backdrop" aria-hidden="true"></div>

  <aside id="a11yPanel" class="a11y-panel" role="dialog" aria-modal="true" aria-labelledby="a11yTitle"
    aria-hidden="true">
    <div class="a11y-panel__header">
      <h2 id="a11yTitle" class="a11y-title">Accessibility</h2>
      <button id="a11yClose" class="a11y-close" type="button" aria-label="Close accessibility panel">Close</button>
    </div>

    <div class="a11y-panel__content">
      <div class="a11y-section">
        <h3>Accessibility Statement</h3>
        <p>
          Crown Shipping Ltd. is committed to providing an accessible experience for all users, including people with
          disabilities.
          This page includes built-in accessibility controls that allow you to adjust text size and readability
          preferences.
        </p>

        <h3 style="margin-top:10px;">Known Limitations</h3>
        <ul>
          <li>Some tables may require horizontal scrolling on small screens.</li>
          <li>Data is displayed as received from the source spreadsheet and may contain abbreviations.</li>
        </ul>

        <h3 style="margin-top:10px;">Assistive Technology & Keyboard Support</h3>
        <ul>
          <li>Keyboard navigation is supported (Tab / Shift+Tab / Enter).</li>
          <li>You can close this panel using the Escape (Esc) key.</li>
          <li>Screen reader users: headings and controls are labeled for improved navigation.</li>
        </ul>

        <div class="a11y-contact">
          <p style="margin:0 0 6px;">
            If you encounter an accessibility issue, please contact us and we will do our best to address it.
          </p>
          <p style="margin:0;">
            Email:
            <a href="mailto:export@crown-shipping.co.il">export@crown-shipping.co.il</a><br/>
            <strong>Statement updated:</strong> January 2026
          </p>
        </div>
      </div>

      <div class="a11y-section">
        <h3>Accessibility Controls</h3>
        <div class="a11y-controls">
          <div class="a11y-row">
            <label for="a11yTheme">Color / Contrast</label>
            <select id="a11yTheme" class="a11y-select">
              <option value="default">Default (Original)</option>
              <option value="high">High Contrast</option>
              <option value="dark">Dark Mode</option>
              <option value="soft">Soft Contrast</option>
              <option value="custom">Custom Colors</option>
            </select>
          </div>

          <div id="a11yCustomColors" class="a11y-colors">
            <div class="a11y-row">
              <label for="a11yBg">Background</label>
              <input id="a11yBg" type="color" value="#ffffff" />
            </div>
            <div class="a11y-row">
              <label for="a11yText">Text</label>
              <input id="a11yText" type="color" value="#111111" />
            </div>
            <div class="a11y-row">
              <label for="a11yLink">Links</label>
              <input id="a11yLink" type="color" value="#2563eb" />
            </div>
          </div>

          <div class="a11y-row">
            <label for="a11yScale">Text size</label>
            <input id="a11yScale" class="a11y-range" type="range" min="1" max="1.6" step="0.05" value="1" />
          </div>

          <div class="a11y-row">
            <label for="a11yUnderlineLinks">Underline links</label>
            <input id="a11yUnderlineLinks" class="a11y-toggle" type="checkbox" />
          </div>

          <div class="a11y-row">
            <label for="a11yLineHeight">Increase line spacing</label>
            <input id="a11yLineHeight" class="a11y-toggle" type="checkbox" />
          </div>

          <div class="a11y-row">
            <label for="a11yLetterSpacing">Increase letter spacing</label>
            <input id="a11yLetterSpacing" class="a11y-toggle" type="checkbox" />
          </div>

          <div class="a11y-row">
            <label for="a11yReadableFont">Readable font</label>
            <input id="a11yReadableFont" class="a11y-toggle" type="checkbox" />
          </div>

          <div class="a11y-row">
            <label for="a11yReduceMotion">Reduce motion</label>
            <input id="a11yReduceMotion" class="a11y-toggle" type="checkbox" />
          </div>

          <div class="a11y-row" style="justify-content:flex-start; gap:8px;">
            <button id="a11ySmaller" class="a11y-btn" type="button" aria-label="Decrease text size">A−</button>
            <button id="a11yBigger" class="a11y-btn" type="button" aria-label="Increase text size">A+</button>
            <button id="a11yReset" class="a11y-btn primary" type="button">Reset to original</button>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <footer class="page-footer">
    Copyright © 2026 Crown Shipping Ltd. All rights reserved.
    &nbsp;|&nbsp;
    <a href="#" id="a11yFooterLink">Accessibility Statement</a>
  </footer>

  
  
  <script>
  (() => {
    const CHECK_EVERY_MS = 60000; 

    const u0 = new URL(window.location.href);
    if (u0.searchParams.get('norefresh') === '1') return;

    
    if (window.__STATUS_WEBAPP_URL) return;

    let current = document.body.getAttribute('data-generated-at') || '';
    let inFlight = false;

    function saveScroll() {
      try { sessionStorage.setItem('scrollY', String(window.scrollY || 0)); } catch (e) {}
    }

    function restoreScroll() {
      try {
        const y = parseInt(sessionStorage.getItem('scrollY') || '0', 10);
        if (!Number.isNaN(y)) window.scrollTo(0, y);
        sessionStorage.removeItem('scrollY');
      } catch (e) {}
    }

    window.addEventListener('load', restoreScroll);

    async function checkForUpdate() {
      if (window.__LIVE_BUSY_ACTIVE) return;
      if (inFlight) return;
      if (document.visibilityState !== 'visible') return;

      inFlight = true;
      try {
        const base = window.location.href.split('?')[0];
        const url = base + '?v=' + Date.now();

        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) return;

        const txt = await res.text();
        const m = txt.match(/data-generated-at="([^"]+)"/);
        const next = (m && m[1]) ? m[1] : '';

        if (next && next !== current) {
          saveScroll();
          window.location.reload();
        }
      } catch (e) {
      } finally {
        inFlight = false;
      }
    }

    setInterval(checkForUpdate, CHECK_EVERY_MS);
  })();
  </script>

</body>
</html>
